# 01. HTTP 개관 \(2\)

### 1.6 TCP 커넥션

#### 1.6.1 TCP/_IP_

* HTTP는 애플리케이션 계층 프로토콜.
  * 네트워크 통신의 핵심적인 세부사항에 대해 신경쓰지 않음.
  * TCP/IP 를 사용.
    * TCP
      * 오류 없는 데이터 전송.
      * 순서에 맞는 전달 - 데이터는 언제나 보낸 순서대로 도착함.
      * 조각나지 않는 데이터 스트림 - 언제든 어떤 크기로든 보낼 수 있음.
* 인터넷 자체가 TCP/IP 에 기초함.
  * TCP/IP
    * TCP와 IP가 층을 이루는, 패킷 교환 네트워크 프로토콜의 집합.
    * 각 네트워크와 하드웨어의 특성을 숨기고, 어떤 종류의 컴퓨터나 네트워크든 서로 신뢰성 있는 의사소통을 하게 해준다.
* 일단 TCP 커넥션이 맺어지면, 클라이언트와 서버간 교환되는 메시지가 없어지거나, 손상되거나, 순서가 뒤바뀌어 수신되는 일은 결코 없음.
* HTTP 프로토콜은 TCP 위의 계층.
  * TCP 는 IP 위의 계층.

#### 1.6.2 접속, IP주소, 그리고 포트번호

* 인터넷 프로토콜\(Internet Protocol, IP\) 주소와 포트번호를 사용해 클라이언트와 서버가 TCP 커넥션을 맺어야, HTTP 클라이언트가 서버에 메시지를 전송할 수 있음.
* HTTP 서버의 IP 주소, 포트번호는 URL을 이용해 알아낼 수 있음.
  * `[http://207.200.83.29:80/index.html](http://207.200.83.29:80/index.html)` - 이미 IP, 포트번호를 알고 있음.
  * `[http://www.netscape.com:80/index.html](http://www.netscape.com:80/index.html)` - 호스트명을 갖고 있음.
    * 호스트 명은 도메인 이름 서비스\(Domain Name Service, DNS\)를 통해 쉽게 IP로 변환됨.
  * `[http://www.netscape.com/index.html](http://www.netscape.com:80/index.html)` - port가 없음. 기본값 80으로 가정.
* 통신 순서
  * URL에서 호스트 명 추출
  * 호스트 명을 IP로 변환
  * 포트번호\(있다면\) 추출
  * 웹 서버와 TCP 커넥션을 맺음
  * 서버에 HTTP 요청 보냄
  * 서버는 HTTP 응답을 돌려줌
  * 커넥션이 닫히면, 웹브라우저는 문서를 보여줌

#### 1.6.3 텔넷\(Telnet\)을 이용한 실제 예제

* telnet
  * 키보드를 목적지의 TCP 포트로 연결해주고, 출력 TCP 포트를 화면으로 연결해준다.
  * 원격 터미널 세션을 위해 흔히 사용됨.
  * HTTP 서버를 포함한 일반적인 TCP 서버에 연결하기 위해 사용될 수도 있음.
* `telnet [www.joes.hardware.com](http://www.joes.hardware.com) 80` 으로 통신 가능.
* nc\(netcat\)

### 1.7 프로토콜 버전

* `HTTP/0.9`
  * 1991년 HTTP 프로토타입.
  * 심각한 디자인 결함 존재.
  * 구식 클라이언트와만 사용.
  * GET만 지원.
  * MIME 타입, 헤더, 버전 번호 지원하지 않음.
  * 원래 간단한 HTML 객체를 받아오기 위해 만들어짐.
* `HTTP/1.0`
  * 처음으로 널리 쓰이기 시작한 HTTP 버전.
  * 헤더, 추가 메서드, 멀티미디어 객체 처리 추가.
  * 시각적으로 매력적인 웹페이지와 상호작용하는 폼을 실현.
  * 결코 잘 정의된 명세가 아님.
* `HTTP/1.0+`
  * 여러 유명 웹 클라이언트와 서버들이 HTTP에 기능을 추가함.
  * keep-alive 커넥션, 가상 호스팅 지원, 프락시 연결 지원.
  * 규격 외의 확장된 HTTP 버전.
* `HTTP/1.1`
  * HTTP 설계의 구조적 결함 교정, 두드러진 성능 최적화, 잘못된 기능 제거.
  * 더 복잡한 웹 애플리케이션, 배포 지원.
  * 현재 버전.
* `HTTP/2.0`
  * `HTTP/1.1`의 성능 문제를 개선하기 위해 구글의 SPDY 프로토콜을 기반으로 설계가 진행 중.

### 1.8 웹의 구성요소

* 프락시 - 클라이언트와 서버 사이에 위치한 HTTP 중개자
* 캐시 - 많이 찾는 웹페이지를 클라이언트 가까이에 보관하는 HTTP 창고
* 게이트웨이 - 다른 애플리케이션과 연결된 특별한 웹 서버
* 터널 - 단순히 HTTP통신을 전달하기만 하는 특별한 프락시
* 에이전트 - 자동화된 HTTP 요청을 만드는 준지능적 웹클라이언트

#### 1.8.1 프락시

* 클라이언트와 서버 사이에 위치.
* 클라이언트의 모든 HTTP 요청을 받아 서버에 전달.
  * 대개 요청을 수정한 뒤
* 사용자를 대신해 서버에 접근.
* 주로 보안을 위해 사용됨.
  * 신뢰할 만한 중개자 역할.
* 요청과 응답 필터링.

#### 1.8.2 캐시

* 웹 캐시, 캐시 프락시
  * 자신을 거쳐 가는 문서들 중 자주 찾는 것의 사본을 저장하는 특별한 종류의 HTTP 프락시 서버.
* 클라이언트가 같은 문서를 요청하면 그 캐시가 갖고 있는 사본을 받을 수 있음.
* 클라이언트는 웹 서버보다 근처의 캐시에서 훨씬 더 빨리 문서를 다운받을 수 있음.
* HTTP는 캐시를 효율적으로 동작하게 하고 캐시된 콘텐츠를 최신버전으로 유지하면서, 동시에 프라이버시도 보하기 위한 많은 기능을 정의함.

#### 1.8.3 게이트웨이

* 다른 서버들의 중개자로 동작하는 특별한 서버.
* HTTP 트래픽을 다른 프로토콜로 변환하기 위해 사용.
* 스스로가 리소스를 갖고 있는 진짜 서버인 것처럼 요청을 다룸.
  * 클라이언트는 게이트웨이와 통신하고 있음을 알아채지 못함.
* `HTTP/FTP` 게이트웨이
  * FTP URI에 대한 HTTP 요청을 받아들인 뒤, FTP 프로토콜을 이용해 문서를 가져옴.
  * 받아온 문서는 HTTP 메시지에 담겨 클라이언트에게 보냄.

#### 1.8.4 터널

* 두 커넥션 사이에서 날\(raw\) 데이터를 열어보지 않고 그대로 전달해주는 HTTP 애플리케이션.
  * 비 HTTP 데이터를 하나 이상의 HTTP 연결을 통해 그대로 전송해주기 위해 사용됨.
* 대표적인 예
  * 암호화된 SSL 트래픽을 HTTP 커넥션으로 전송함으로써 웹 트래픽만 허용하는 사내 방화병을 통과시키는 것.

#### 1.8.5 에이전트

* 사용자를 위해 HTTP 요청을 만들어주는 클라이언트 프로그램.
* 웹 요청을 만드는 애플리케이션은 뭐든 HTTP 에이전트.
* 자동화된 사용자 에이전트
  * 스파이더
  * 웹로봇

